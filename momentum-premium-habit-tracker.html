<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Momentum ‚Äî Premium Habit System</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; }
        
        /* Premium scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }
        
        /* Animations */
        @keyframes float { 
            0%, 100% { transform: translateY(0px) rotate(0deg); } 
            50% { transform: translateY(-20px) rotate(5deg); } 
        }
        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.2) rotate(-5deg); }
            50% { transform: scale(1.3); }
            75% { transform: scale(1.2) rotate(5deg); }
        }
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(168, 85, 247, 0.4); }
            50% { box-shadow: 0 0 40px rgba(168, 85, 247, 0.8); }
        }
        @keyframes slide-up { 
            from { transform: translateY(100%); opacity: 0; } 
            to { transform: translateY(0); opacity: 1; } 
        }
        @keyframes slide-down {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes bounce-in {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes number-pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.4); }
            100% { transform: scale(1); }
        }
        @keyframes streak-fire {
            0%, 100% { transform: scale(1) translateY(0); }
            50% { transform: scale(1.1) translateY(-3px); }
        }
        @keyframes card-complete {
            0% { transform: scale(1); }
            30% { transform: scale(0.95); }
            60% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        @keyframes ripple {
            0% { transform: scale(0); opacity: 0.6; }
            100% { transform: scale(4); opacity: 0; }
        }
        
        .animate-float { animation: float 6s ease-in-out infinite; }
        .animate-slide-up { animation: slide-up 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .animate-slide-down { animation: slide-down 0.3s ease-out; }
        .animate-bounce-in { animation: bounce-in 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        .animate-celebrate { animation: celebrate 0.6s ease-in-out; }
        .animate-glow { animation: glow 2s ease-in-out infinite; }
        .animate-number-pop { animation: number-pop 0.3s ease-out; }
        .animate-streak-fire { animation: streak-fire 0.5s ease-in-out; }
        .animate-card-complete { animation: card-complete 0.4s ease-out; }
        
        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .glass-dark {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        
        .premium-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%);
            box-shadow: 0 4px 24px -4px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0, 0, 0, 0.02);
        }
        
        .premium-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        }
        
        .text-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .habit-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .habit-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px -12px rgba(0, 0, 0, 0.15);
        }
        .habit-card:active {
            transform: scale(0.98);
        }
        
        .btn-premium {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .btn-premium::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        .btn-premium:active::before {
            width: 300px;
            height: 300px;
        }
        
        .progress-ring {
            transition: stroke-dashoffset 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: confetti-fall 3s linear forwards;
        }
        
        .streak-badge {
            background: linear-gradient(135deg, #ff9a56 0%, #ff6b6b 100%);
        }
        
        .level-badge {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        /* Dark mode styles */
        .dark .premium-card {
            background: linear-gradient(135deg, rgba(30,30,40,0.95) 0%, rgba(20,20,30,0.9) 100%);
            box-shadow: 0 4px 24px -4px rgba(0, 0, 0, 0.4);
        }
        .dark .bg-white { background-color: #1a1a2e !important; }
        .dark .text-gray-800 { color: #f0f0f0 !important; }
        .dark .text-gray-700 { color: #d0d0d0 !important; }
        .dark .text-gray-600 { color: #a0a0a0 !important; }
        .dark .text-gray-500 { color: #808080 !important; }
        .dark .bg-gray-50 { background-color: #252540 !important; }
        .dark .bg-gray-100 { background-color: #2a2a45 !important; }
        .dark .border-gray-200 { border-color: #3a3a55 !important; }
        
        /* Tab bar styling */
        .tab-bar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        .dark .tab-bar {
            background: rgba(26, 26, 46, 0.95);
        }
        
        /* Analytics chart bars */
        .chart-bar {
            transition: height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Insight cards */
        .insight-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border: 1px solid rgba(102, 126, 234, 0.2);
        }
        
        /* Premium badge shimmer */
        .premium-badge {
            position: relative;
            overflow: hidden;
        }
        .premium-badge::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 3s infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;

        // Storage helper
        const storage = {
            get: (key, defaultValue) => {
                try {
                    const item = localStorage.getItem(key);
                    return item ? JSON.parse(item) : defaultValue;
                } catch { return defaultValue; }
            },
            set: (key, value) => {
                try {
                    localStorage.setItem(key, JSON.stringify(value));
                } catch {}
            }
        };

        // Confetti component
        const Confetti = ({ active }) => {
            if (!active) return null;
            const colors = ['#667eea', '#764ba2', '#f093fb', '#ff6b6b', '#feca57', '#48dbfb', '#1dd1a1'];
            return (
                <div className="fixed inset-0 pointer-events-none z-50">
                    {Array.from({ length: 50 }).map((_, i) => (
                        <div
                            key={i}
                            className="confetti"
                            style={{
                                left: `${Math.random() * 100}%`,
                                backgroundColor: colors[Math.floor(Math.random() * colors.length)],
                                animationDelay: `${Math.random() * 0.5}s`,
                                borderRadius: Math.random() > 0.5 ? '50%' : '2px',
                                width: `${8 + Math.random() * 8}px`,
                                height: `${8 + Math.random() * 8}px`,
                            }}
                        />
                    ))}
                </div>
            );
        };

        // Circular progress component
        const CircularProgress = ({ progress, size = 120, strokeWidth = 8, children }) => {
            const radius = (size - strokeWidth) / 2;
            const circumference = radius * 2 * Math.PI;
            const offset = circumference - (progress / 100) * circumference;
            
            return (
                <div className="relative" style={{ width: size, height: size }}>
                    <svg width={size} height={size} className="transform -rotate-90">
                        <circle
                            cx={size / 2}
                            cy={size / 2}
                            r={radius}
                            fill="none"
                            stroke="rgba(0,0,0,0.05)"
                            strokeWidth={strokeWidth}
                        />
                        <circle
                            cx={size / 2}
                            cy={size / 2}
                            r={radius}
                            fill="none"
                            stroke="url(#progressGradient)"
                            strokeWidth={strokeWidth}
                            strokeLinecap="round"
                            strokeDasharray={circumference}
                            strokeDashoffset={offset}
                            className="progress-ring"
                        />
                        <defs>
                            <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stopColor="#667eea" />
                                <stop offset="100%" stopColor="#764ba2" />
                            </linearGradient>
                        </defs>
                    </svg>
                    <div className="absolute inset-0 flex items-center justify-center">
                        {children}
                    </div>
                </div>
            );
        };

        // Main App
        function MomentumApp() {
            // Persisted state
            const [habits, setHabits] = useState(() => storage.get('momentum_habits', [
                { id: 1, name: 'Morning meditation', emoji: 'üßò', color: 'from-violet-500 to-purple-600', streak: 12, completedDates: [], category: 'Wellness', reminder: '07:00', identity: 'mindful person', goal: 1, progress: {} },
                { id: 2, name: 'Read 20 pages', emoji: 'üìö', color: 'from-blue-500 to-cyan-500', streak: 7, completedDates: [], category: 'Learning', reminder: '21:00', identity: 'lifelong learner', goal: 20, progress: {}, unit: 'pages' },
                { id: 3, name: 'Exercise', emoji: 'üí™', color: 'from-green-500 to-emerald-500', streak: 5, completedDates: [], category: 'Fitness', reminder: '06:30', identity: 'athlete', goal: 30, progress: {}, unit: 'min' },
                { id: 4, name: 'Drink 8 glasses water', emoji: 'üíß', color: 'from-cyan-400 to-blue-500', streak: 21, completedDates: [], category: 'Health', reminder: null, identity: 'healthy person', goal: 8, progress: {}, unit: 'glasses' },
            ]));
            
            const [showTemplates, setShowTemplates] = useState(false);
            
            // Habit templates
            const habitTemplates = [
                // Health
                { name: 'Drink water', emoji: 'üíß', color: 'from-cyan-400 to-blue-500', category: 'Health', identity: 'healthy person', goal: 8, unit: 'glasses' },
                { name: 'Take vitamins', emoji: 'üíä', color: 'from-green-400 to-emerald-500', category: 'Health', identity: 'healthy person', goal: 1, unit: '' },
                { name: 'Eat vegetables', emoji: 'ü•ó', color: 'from-green-500 to-teal-500', category: 'Health', identity: 'healthy eater', goal: 5, unit: 'servings' },
                { name: 'No junk food', emoji: 'üö´', color: 'from-red-400 to-rose-500', category: 'Health', identity: 'healthy eater', goal: 1, unit: '' },
                { name: 'Sleep 8 hours', emoji: 'üò¥', color: 'from-indigo-400 to-purple-500', category: 'Health', identity: 'well-rested person', goal: 8, unit: 'hours' },
                
                // Fitness
                { name: 'Exercise', emoji: 'üí™', color: 'from-orange-500 to-red-500', category: 'Fitness', identity: 'athlete', goal: 30, unit: 'min' },
                { name: 'Walk steps', emoji: 'üö∂', color: 'from-green-500 to-emerald-500', category: 'Fitness', identity: 'active person', goal: 10000, unit: 'steps' },
                { name: 'Stretch', emoji: 'ü§∏', color: 'from-pink-400 to-rose-500', category: 'Fitness', identity: 'flexible person', goal: 10, unit: 'min' },
                { name: 'Run', emoji: 'üèÉ', color: 'from-blue-500 to-cyan-500', category: 'Fitness', identity: 'runner', goal: 3, unit: 'km' },
                { name: 'Yoga', emoji: 'üßò', color: 'from-purple-400 to-pink-500', category: 'Fitness', identity: 'yogi', goal: 20, unit: 'min' },
                { name: 'Push-ups', emoji: 'ü´∏', color: 'from-red-500 to-orange-500', category: 'Fitness', identity: 'strong person', goal: 50, unit: 'reps' },
                
                // Wellness
                { name: 'Meditate', emoji: 'üßò', color: 'from-violet-500 to-purple-600', category: 'Wellness', identity: 'mindful person', goal: 10, unit: 'min' },
                { name: 'Journal', emoji: 'üìù', color: 'from-amber-400 to-orange-500', category: 'Wellness', identity: 'reflective person', goal: 1, unit: '' },
                { name: 'Gratitude list', emoji: 'üôè', color: 'from-pink-400 to-rose-500', category: 'Wellness', identity: 'grateful person', goal: 3, unit: 'things' },
                { name: 'Deep breathing', emoji: 'üå¨Ô∏è', color: 'from-cyan-400 to-blue-500', category: 'Wellness', identity: 'calm person', goal: 5, unit: 'min' },
                { name: 'No social media', emoji: 'üìµ', color: 'from-gray-500 to-slate-600', category: 'Wellness', identity: 'focused person', goal: 1, unit: '' },
                
                // Learning
                { name: 'Read', emoji: 'üìö', color: 'from-blue-500 to-indigo-500', category: 'Learning', identity: 'reader', goal: 20, unit: 'pages' },
                { name: 'Learn language', emoji: 'üó£Ô∏è', color: 'from-green-500 to-teal-500', category: 'Learning', identity: 'polyglot', goal: 15, unit: 'min' },
                { name: 'Online course', emoji: 'üíª', color: 'from-purple-500 to-pink-500', category: 'Learning', identity: 'lifelong learner', goal: 1, unit: 'lesson' },
                { name: 'Practice coding', emoji: 'üë®‚Äçüíª', color: 'from-emerald-500 to-cyan-500', category: 'Learning', identity: 'developer', goal: 30, unit: 'min' },
                { name: 'Watch documentary', emoji: 'üé¨', color: 'from-red-500 to-rose-500', category: 'Learning', identity: 'curious person', goal: 1, unit: '' },
                
                // Productivity  
                { name: 'Plan tomorrow', emoji: 'üìã', color: 'from-blue-500 to-cyan-500', category: 'Productivity', identity: 'organized person', goal: 1, unit: '' },
                { name: 'Deep work', emoji: 'üéØ', color: 'from-red-500 to-orange-500', category: 'Productivity', identity: 'focused achiever', goal: 2, unit: 'hours' },
                { name: 'Inbox zero', emoji: 'üìß', color: 'from-gray-500 to-slate-600', category: 'Productivity', identity: 'organized person', goal: 1, unit: '' },
                { name: 'Review goals', emoji: 'üéØ', color: 'from-violet-500 to-purple-600', category: 'Productivity', identity: 'goal-oriented person', goal: 1, unit: '' },
                { name: 'No procrastination', emoji: '‚è∞', color: 'from-amber-500 to-orange-500', category: 'Productivity', identity: 'action-taker', goal: 1, unit: '' },
                
                // Social
                { name: 'Call family/friend', emoji: 'üìû', color: 'from-green-500 to-emerald-500', category: 'Social', identity: 'connected person', goal: 1, unit: '' },
                { name: 'Quality time', emoji: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶', color: 'from-pink-500 to-rose-500', category: 'Social', identity: 'present person', goal: 30, unit: 'min' },
                { name: 'Help someone', emoji: 'ü§ù', color: 'from-amber-400 to-orange-500', category: 'Social', identity: 'kind person', goal: 1, unit: '' },
                { name: 'Network', emoji: 'üåê', color: 'from-blue-500 to-indigo-500', category: 'Social', identity: 'connector', goal: 1, unit: '' },
                
                // Creative
                { name: 'Draw/Sketch', emoji: 'üé®', color: 'from-pink-500 to-purple-500', category: 'Creative', identity: 'artist', goal: 15, unit: 'min' },
                { name: 'Write', emoji: '‚úçÔ∏è', color: 'from-amber-500 to-orange-500', category: 'Creative', identity: 'writer', goal: 500, unit: 'words' },
                { name: 'Practice music', emoji: 'üé∏', color: 'from-red-500 to-pink-500', category: 'Creative', identity: 'musician', goal: 30, unit: 'min' },
                { name: 'Photography', emoji: 'üì∑', color: 'from-gray-600 to-slate-700', category: 'Creative', identity: 'photographer', goal: 5, unit: 'photos' },
                { name: 'Create content', emoji: 'üé•', color: 'from-red-500 to-rose-500', category: 'Creative', identity: 'creator', goal: 1, unit: '' },
            ];
            
            const [user, setUser] = useState(() => storage.get('momentum_user', {
                name: 'Champion',
                avatar: 'ü¶∏',
                level: 1,
                xp: 0,
                totalCompletions: 0,
                perfectDays: 0,
                longestStreak: 0,
                joinDate: new Date().toISOString(),
                theme: 'purple',
                achievements: []
            }));
            
            const [completionHistory, setCompletionHistory] = useState(() => storage.get('momentum_history', {}));
            
            // UI state
            const [activeTab, setActiveTab] = useState('habits');
            const [showConfetti, setShowConfetti] = useState(false);
            const [showLevelUp, setShowLevelUp] = useState(false);
            const [newLevel, setNewLevel] = useState(1);
            const [showAddHabit, setShowAddHabit] = useState(false);
            const [showAchievement, setShowAchievement] = useState(null);
            const [darkMode, setDarkMode] = useState(() => storage.get('momentum_dark', false));
            const [completedAnimation, setCompletedAnimation] = useState(null);
            const [showOnboarding, setShowOnboarding] = useState(() => storage.get('momentum_onboarded', false) === false);
            const [onboardingStep, setOnboardingStep] = useState(0);
            const [showHabitDetail, setShowHabitDetail] = useState(null);
            const [weekOffset, setWeekOffset] = useState(0);

            // Save to storage
            useEffect(() => { storage.set('momentum_habits', habits); }, [habits]);
            useEffect(() => { storage.set('momentum_user', user); }, [user]);
            useEffect(() => { storage.set('momentum_history', completionHistory); }, [completionHistory]);
            useEffect(() => { storage.set('momentum_dark', darkMode); }, [darkMode]);

            // Computed values
            const today = new Date().toISOString().split('T')[0];
            
            const todayCompletions = useMemo(() => {
                return habits.filter(h => {
                    const todayProgress = h.progress?.[today] || 0;
                    return todayProgress >= (h.goal || 1);
                }).length;
            }, [habits, today]);
            
            const completionRate = useMemo(() => {
                return habits.length > 0 ? Math.round((todayCompletions / habits.length) * 100) : 0;
            }, [todayCompletions, habits.length]);

            const weekDays = useMemo(() => {
                const days = [];
                const baseDate = new Date();
                baseDate.setDate(baseDate.getDate() + weekOffset * 7);
                const startOfWeek = new Date(baseDate);
                startOfWeek.setDate(startOfWeek.getDate() - startOfWeek.getDay());
                
                for (let i = 0; i < 7; i++) {
                    const date = new Date(startOfWeek);
                    date.setDate(date.getDate() + i);
                    days.push({
                        date: date.toISOString().split('T')[0],
                        day: date.toLocaleDateString('en', { weekday: 'short' }),
                        num: date.getDate(),
                        isToday: date.toISOString().split('T')[0] === today
                    });
                }
                return days;
            }, [today, weekOffset]);

            // Analytics data
            const analyticsData = useMemo(() => {
                const last30Days = [];
                for (let i = 29; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toISOString().split('T')[0];
                    const completions = habits.filter(h => {
                        const dayProgress = h.progress?.[dateStr] || 0;
                        const goal = h.goal || 1;
                        return dayProgress >= goal || h.completedDates?.includes(dateStr);
                    }).length;
                    last30Days.push({
                        date: dateStr,
                        completions,
                        rate: habits.length > 0 ? Math.round((completions / habits.length) * 100) : 0
                    });
                }
                
                const avgRate = last30Days.reduce((sum, d) => sum + d.rate, 0) / 30;
                const bestDay = last30Days.reduce((best, d) => d.rate > best.rate ? d : best, { rate: 0 });
                const currentWeekRate = last30Days.slice(-7).reduce((sum, d) => sum + d.rate, 0) / 7;
                const prevWeekRate = last30Days.slice(-14, -7).reduce((sum, d) => sum + d.rate, 0) / 7;
                const trend = currentWeekRate - prevWeekRate;
                
                return { last30Days, avgRate, bestDay, currentWeekRate, trend };
            }, [habits]);

            // Achievements system
            const allAchievements = [
                { id: 'first_step', name: 'First Step', emoji: 'üå±', desc: 'Complete your first habit', check: (u) => u.totalCompletions >= 1 },
                { id: 'week_warrior', name: 'Week Warrior', emoji: '‚öîÔ∏è', desc: 'Complete 7 habits', check: (u) => u.totalCompletions >= 7 },
                { id: 'habit_master', name: 'Habit Master', emoji: 'üèÖ', desc: 'Complete 50 habits', check: (u) => u.totalCompletions >= 50 },
                { id: 'centurion', name: 'Centurion', emoji: 'üíØ', desc: 'Complete 100 habits', check: (u) => u.totalCompletions >= 100 },
                { id: 'perfect_day', name: 'Perfect Day', emoji: 'üíé', desc: 'Complete all habits in a day', check: (u) => u.perfectDays >= 1 },
                { id: 'perfect_week', name: 'Perfect Week', emoji: 'üëë', desc: 'Have 7 perfect days', check: (u) => u.perfectDays >= 7 },
                { id: 'streak_3', name: 'Getting Warm', emoji: 'üî•', desc: 'Reach a 3-day streak', check: (u) => u.longestStreak >= 3 },
                { id: 'streak_7', name: 'On Fire', emoji: 'üåü', desc: 'Reach a 7-day streak', check: (u) => u.longestStreak >= 7 },
                { id: 'streak_30', name: 'Unstoppable', emoji: 'üöÄ', desc: 'Reach a 30-day streak', check: (u) => u.longestStreak >= 30 },
                { id: 'level_5', name: 'Rising Star', emoji: '‚≠ê', desc: 'Reach Level 5', check: (u) => u.level >= 5 },
                { id: 'level_10', name: 'Champion', emoji: 'üèÜ', desc: 'Reach Level 10', check: (u) => u.level >= 10 },
                { id: 'early_bird', name: 'Early Bird', emoji: 'üê¶', desc: 'Complete a habit before 7am', check: (u) => u.achievements?.includes('early_bird_earned') },
            ];

            const checkAchievements = useCallback((updatedUser) => {
                const newAchievements = [];
                allAchievements.forEach(achievement => {
                    if (!updatedUser.achievements?.includes(achievement.id) && achievement.check(updatedUser)) {
                        newAchievements.push(achievement.id);
                    }
                });
                
                if (newAchievements.length > 0) {
                    const firstNew = allAchievements.find(a => a.id === newAchievements[0]);
                    setShowAchievement(firstNew);
                    setTimeout(() => setShowAchievement(null), 3000);
                    
                    return [...(updatedUser.achievements || []), ...newAchievements];
                }
                return updatedUser.achievements || [];
            }, []);

            // Increment habit progress (partial completion)
            const incrementHabit = useCallback((habitId, amount = 1) => {
                const habit = habits.find(h => h.id === habitId);
                if (!habit) return;
                
                const currentProgress = habit.progress?.[today] || 0;
                const goal = habit.goal || 1;
                
                // Already completed
                if (currentProgress >= goal) return;
                
                const newProgress = Math.min(currentProgress + amount, goal);
                const justCompleted = currentProgress < goal && newProgress >= goal;

                setCompletedAnimation(habitId);
                setTimeout(() => setCompletedAnimation(null), 600);

                // Update habit progress
                const updatedHabits = habits.map(h => {
                    if (h.id === habitId) {
                        const newProgressData = { ...h.progress, [today]: newProgress };
                        let newStreak = h.streak;
                        let newCompletedDates = [...(h.completedDates || [])];
                        
                        // If just completed today
                        if (justCompleted && !h.completedDates?.includes(today)) {
                            newCompletedDates.push(today);
                            const yesterday = new Date();
                            yesterday.setDate(yesterday.getDate() - 1);
                            const yesterdayStr = yesterday.toISOString().split('T')[0];
                            newStreak = h.completedDates?.includes(yesterdayStr) ? h.streak + 1 : 1;
                        }
                        
                        return { ...h, progress: newProgressData, completedDates: newCompletedDates, streak: newStreak };
                    }
                    return h;
                });
                setHabits(updatedHabits);

                // Only award XP and update stats when habit is completed
                if (justCompleted) {
                    // Update history
                    setCompletionHistory(prev => ({
                        ...prev,
                        [today]: [...(prev[today] || []), habitId]
                    }));

                    // Calculate XP and level
                    const xpGain = 25;
                    const newXP = user.xp + xpGain;
                    let newLevel = user.level;
                    let remainingXP = newXP;
                    
                    while (remainingXP >= newLevel * 100) {
                        remainingXP -= newLevel * 100;
                        newLevel++;
                    }

                    // Check for perfect day
                    const completedCount = updatedHabits.filter(h => (h.progress?.[today] || 0) >= (h.goal || 1)).length;
                    const willBePerfect = completedCount === updatedHabits.length;
                    
                    // Check for new longest streak
                    const maxStreak = Math.max(...updatedHabits.map(h => h.streak));

                    // Update user
                    const updatedUser = {
                        ...user,
                        xp: remainingXP,
                        level: newLevel,
                        totalCompletions: user.totalCompletions + 1,
                        perfectDays: willBePerfect && !user.perfectDaysToday ? user.perfectDays + 1 : user.perfectDays,
                        perfectDaysToday: willBePerfect,
                        longestStreak: Math.max(user.longestStreak, maxStreak)
                    };

                    // Check achievements
                    updatedUser.achievements = checkAchievements(updatedUser);
                    
                    setUser(updatedUser);

                    // Level up celebration
                    if (newLevel > user.level) {
                        setNewLevel(newLevel);
                        setShowLevelUp(true);
                        setShowConfetti(true);
                        setTimeout(() => {
                            setShowLevelUp(false);
                            setShowConfetti(false);
                        }, 3000);
                    }

                    // Perfect day celebration
                    if (willBePerfect) {
                        setShowConfetti(true);
                        setTimeout(() => setShowConfetti(false), 3000);
                    }
                }
            }, [habits, today, user, checkAchievements]);

            // Quick complete (for goal=1 habits)
            const completeHabit = useCallback((habitId) => {
                incrementHabit(habitId, 1);
            }, [incrementHabit]);

            // Add new habit
            const addHabit = useCallback((habitData) => {
                const newHabit = {
                    id: Date.now(),
                    name: habitData.name,
                    emoji: habitData.emoji || '‚≠ê',
                    color: habitData.color || 'from-violet-500 to-purple-600',
                    streak: 0,
                    completedDates: [],
                    category: habitData.category || 'General',
                    reminder: habitData.reminder || null,
                    identity: habitData.identity || '',
                    goal: habitData.goal || 1,
                    unit: habitData.unit || '',
                    progress: {}
                };
                setHabits(prev => [...prev, newHabit]);
                setShowAddHabit(false);
                setShowTemplates(false);
            }, []);
            
            // Add from template
            const addFromTemplate = useCallback((template) => {
                addHabit({
                    name: template.name,
                    emoji: template.emoji,
                    color: template.color,
                    category: template.category,
                    identity: template.identity,
                    goal: template.goal,
                    unit: template.unit
                });
            }, [addHabit]);

            // Delete habit
            const deleteHabit = useCallback((habitId) => {
                setHabits(prev => prev.filter(h => h.id !== habitId));
                setShowHabitDetail(null);
            }, []);

            // Themes
            const themes = {
                purple: 'from-violet-600 via-purple-600 to-fuchsia-600',
                ocean: 'from-cyan-500 via-blue-600 to-indigo-600',
                sunset: 'from-orange-500 via-rose-500 to-pink-600',
                forest: 'from-emerald-500 via-green-600 to-teal-600',
                midnight: 'from-slate-900 via-purple-900 to-slate-800',
            };

            // Onboarding steps
            const onboardingSteps = [
                { title: 'Welcome to Momentum', subtitle: 'Your premium habit companion', emoji: 'üöÄ', desc: 'Build lasting habits with beautiful tracking, smart insights, and rewarding achievements.' },
                { title: 'Track Daily Progress', subtitle: 'One tap to success', emoji: '‚ú®', desc: 'Complete habits with a single tap. Watch your streaks grow and earn XP with every completion.' },
                { title: 'Unlock Achievements', subtitle: 'Celebrate your wins', emoji: 'üèÜ', desc: 'Earn badges for consistency, perfect days, and reaching new levels. Your progress matters!' },
                { title: 'Gain Insights', subtitle: 'Understand your patterns', emoji: 'üìä', desc: 'Beautiful analytics show your trends, best days, and areas for growth.' },
            ];

            const finishOnboarding = () => {
                setShowOnboarding(false);
                storage.set('momentum_onboarded', true);
            };

            // Categories
            const categories = ['All', 'Health', 'Fitness', 'Wellness', 'Learning', 'Productivity', 'Social', 'Creative'];
            const [selectedCategory, setSelectedCategory] = useState('All');
            
            const filteredHabits = useMemo(() => {
                if (selectedCategory === 'All') return habits;
                return habits.filter(h => h.category === selectedCategory);
            }, [habits, selectedCategory]);

            // Motivational quotes
            const quotes = [
                { text: "Small daily improvements are the key to staggering long-term results.", author: "James Clear" },
                { text: "We are what we repeatedly do. Excellence is not an act, but a habit.", author: "Aristotle" },
                { text: "Success is the sum of small efforts repeated day in and day out.", author: "Robert Collier" },
                { text: "The secret of your future is hidden in your daily routine.", author: "Mike Murdock" },
            ];
            const todayQuote = quotes[new Date().getDay() % quotes.length];

            return (
                <div className={`min-h-screen bg-gradient-to-br ${themes[user.theme]} ${darkMode ? 'dark' : ''}`}>
                    <Confetti active={showConfetti} />
                    
                    {/* Level Up Modal */}
                    {showLevelUp && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm">
                            <div className="bg-white dark:bg-gray-900 rounded-3xl p-8 m-4 text-center animate-bounce-in max-w-sm">
                                <div className="text-7xl mb-4 animate-celebrate">üéâ</div>
                                <h2 className="text-3xl font-black text-gray-800 dark:text-white mb-2">LEVEL UP!</h2>
                                <div className="text-6xl font-black text-gradient mb-4">{newLevel}</div>
                                <p className="text-gray-600 dark:text-gray-400">You're making incredible progress!</p>
                            </div>
                        </div>
                    )}

                    {/* Achievement Toast */}
                    {showAchievement && (
                        <div className="fixed top-4 left-1/2 -translate-x-1/2 z-50 animate-slide-down">
                            <div className="glass rounded-2xl px-6 py-4 flex items-center gap-4 shadow-2xl">
                                <div className="text-4xl animate-celebrate">{showAchievement.emoji}</div>
                                <div className="text-white">
                                    <p className="text-xs font-medium opacity-80">Achievement Unlocked!</p>
                                    <p className="font-bold text-lg">{showAchievement.name}</p>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Onboarding */}
                    {showOnboarding && (
                        <div className="fixed inset-0 z-50 bg-gradient-to-br from-violet-600 via-purple-600 to-fuchsia-600 flex items-center justify-center p-6">
                            <div className="max-w-md w-full">
                                <div className="text-center mb-8 animate-bounce-in">
                                    <div className="text-8xl mb-6">{onboardingSteps[onboardingStep].emoji}</div>
                                    <h1 className="text-3xl font-black text-white mb-2">{onboardingSteps[onboardingStep].title}</h1>
                                    <p className="text-white/80 text-lg mb-4">{onboardingSteps[onboardingStep].subtitle}</p>
                                    <p className="text-white/60">{onboardingSteps[onboardingStep].desc}</p>
                                </div>
                                
                                <div className="flex justify-center gap-2 mb-8">
                                    {onboardingSteps.map((_, i) => (
                                        <div key={i} className={`h-2 rounded-full transition-all duration-300 ${i === onboardingStep ? 'w-8 bg-white' : 'w-2 bg-white/30'}`} />
                                    ))}
                                </div>

                                <button
                                    onClick={() => onboardingStep < onboardingSteps.length - 1 ? setOnboardingStep(s => s + 1) : finishOnboarding()}
                                    className="w-full py-4 bg-white text-purple-600 rounded-2xl font-bold text-lg shadow-xl hover:shadow-2xl transition-all active:scale-95"
                                >
                                    {onboardingStep < onboardingSteps.length - 1 ? 'Continue' : 'Get Started'}
                                </button>
                                
                                {onboardingStep < onboardingSteps.length - 1 && (
                                    <button onClick={finishOnboarding} className="w-full mt-3 py-2 text-white/60 text-sm">
                                        Skip intro
                                    </button>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Header */}
                    <header className="glass sticky top-0 z-30 px-5 py-4">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="w-12 h-12 rounded-2xl bg-white/20 flex items-center justify-center text-2xl">
                                    {user.avatar}
                                </div>
                                <div className="text-white">
                                    <h1 className="font-bold text-lg leading-tight">Hey, {user.name}!</h1>
                                    <div className="flex items-center gap-2 text-sm opacity-80">
                                        <span className="level-badge px-2 py-0.5 rounded-full text-xs font-bold">Lv.{user.level}</span>
                                        <span>{user.xp}/{user.level * 100} XP</span>
                                    </div>
                                </div>
                            </div>
                            <div className="flex items-center gap-2">
                                <button
                                    onClick={() => setDarkMode(!darkMode)}
                                    className="w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center text-white hover:bg-white/30 transition-colors"
                                >
                                    {darkMode ? '‚òÄÔ∏è' : 'üåô'}
                                </button>
                            </div>
                        </div>
                        
                        {/* XP Progress Bar */}
                        <div className="mt-3 h-2 bg-white/20 rounded-full overflow-hidden">
                            <div 
                                className="h-full bg-gradient-to-r from-yellow-400 to-orange-500 transition-all duration-500"
                                style={{ width: `${(user.xp / (user.level * 100)) * 100}%` }}
                            />
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="pb-24">
                        {activeTab === 'habits' && (
                            <div className="px-5 py-6 space-y-6 animate-slide-down">
                                {/* Today's Progress Card */}
                                <div className="premium-card rounded-3xl p-6">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <h2 className="text-sm font-medium text-gray-500 dark:text-gray-400 mb-1">Today's Progress</h2>
                                            <p className="text-4xl font-black text-gray-800 dark:text-white">
                                                {todayCompletions}<span className="text-lg font-medium text-gray-400">/{habits.length}</span>
                                            </p>
                                            <p className="text-sm text-gray-500 mt-1">
                                                {completionRate === 100 ? 'üéâ Perfect day!' : completionRate >= 50 ? 'üí™ Keep going!' : 'üåü You got this!'}
                                            </p>
                                        </div>
                                        <CircularProgress progress={completionRate} size={100} strokeWidth={8}>
                                            <div className="text-center">
                                                <span className="text-2xl font-black text-gray-800 dark:text-white">{completionRate}%</span>
                                            </div>
                                        </CircularProgress>
                                    </div>
                                </div>

                                {/* Week View */}
                                <div className="premium-card rounded-3xl p-5">
                                    <div className="flex items-center justify-between mb-4">
                                        <button onClick={() => setWeekOffset(w => w - 1)} className="p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors">
                                            <span className="text-gray-400">‚Üê</span>
                                        </button>
                                        <h3 className="font-bold text-gray-800 dark:text-white">
                                            {weekOffset === 0 ? 'This Week' : weekOffset === -1 ? 'Last Week' : `${Math.abs(weekOffset)} weeks ago`}
                                        </h3>
                                        <button onClick={() => setWeekOffset(w => Math.min(0, w + 1))} className="p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-colors" disabled={weekOffset >= 0}>
                                            <span className={weekOffset >= 0 ? 'text-gray-200' : 'text-gray-400'}>‚Üí</span>
                                        </button>
                                    </div>
                                    <div className="grid grid-cols-7 gap-2">
                                        {weekDays.map(day => {
                                            const dayCompletions = habits.filter(h => {
                                                const dayProgress = h.progress?.[day.date] || 0;
                                                const goal = h.goal || 1;
                                                return dayProgress >= goal || h.completedDates?.includes(day.date);
                                            }).length;
                                            const dayRate = habits.length > 0 ? dayCompletions / habits.length : 0;
                                            return (
                                                <div key={day.date} className={`text-center py-3 rounded-2xl transition-all ${day.isToday ? 'bg-gradient-to-br from-violet-500 to-purple-600 text-white shadow-lg' : 'bg-gray-50 dark:bg-gray-800'}`}>
                                                    <p className={`text-xs font-medium mb-1 ${day.isToday ? 'text-white/80' : 'text-gray-400'}`}>{day.day}</p>
                                                    <p className={`text-lg font-bold ${day.isToday ? 'text-white' : 'text-gray-800 dark:text-white'}`}>{day.num}</p>
                                                    <div className={`mx-auto mt-2 w-2 h-2 rounded-full ${dayRate === 1 ? 'bg-green-400' : dayRate > 0 ? 'bg-yellow-400' : 'bg-gray-200 dark:bg-gray-600'}`} />
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>

                                {/* Motivation Card */}
                                <div className="bg-gradient-to-br from-amber-400 via-orange-400 to-rose-400 rounded-3xl p-5 text-white relative overflow-hidden">
                                    <div className="absolute -right-4 -top-4 text-8xl opacity-20 animate-float">üí°</div>
                                    <p className="text-lg font-medium italic leading-relaxed relative z-10">"{todayQuote.text}"</p>
                                    <p className="text-sm mt-2 opacity-80 font-semibold">‚Äî {todayQuote.author}</p>
                                </div>

                                {/* Category Filter */}
                                <div className="flex gap-2 overflow-x-auto pb-2 -mx-5 px-5 scrollbar-hide">
                                    {categories.map(cat => (
                                        <button
                                            key={cat}
                                            onClick={() => setSelectedCategory(cat)}
                                            className={`px-4 py-2 rounded-xl text-sm font-semibold whitespace-nowrap transition-all ${
                                                selectedCategory === cat 
                                                    ? 'bg-gradient-to-r from-violet-500 to-purple-600 text-white shadow-lg' 
                                                    : 'bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 shadow'
                                            }`}
                                        >
                                            {cat}
                                        </button>
                                    ))}
                                </div>

                                {/* Habits List */}
                                <div className="space-y-3">
                                    {filteredHabits.map(habit => {
                                        const todayProgress = habit.progress?.[today] || 0;
                                        const goal = habit.goal || 1;
                                        const isCompleted = todayProgress >= goal;
                                        const progressPercent = Math.min((todayProgress / goal) * 100, 100);
                                        const isAnimating = completedAnimation === habit.id;
                                        const hasMultipleSteps = goal > 1;
                                        
                                        return (
                                            <div 
                                                key={habit.id}
                                                className={`habit-card premium-card rounded-2xl overflow-hidden ${isAnimating ? 'animate-card-complete' : ''} ${isCompleted ? 'ring-2 ring-green-400 ring-offset-2' : ''}`}
                                            >
                                                <div className="p-4">
                                                    <div className="flex items-center gap-4">
                                                        <button
                                                            onClick={() => !isCompleted && incrementHabit(habit.id, 1)}
                                                            className={`w-14 h-14 rounded-2xl flex items-center justify-center text-2xl transition-all btn-premium relative ${
                                                                isCompleted 
                                                                    ? 'bg-gradient-to-br from-green-400 to-emerald-500 text-white shadow-lg' 
                                                                    : `bg-gradient-to-br ${habit.color} text-white shadow-md hover:shadow-lg`
                                                            }`}
                                                        >
                                                            {isCompleted ? '‚úì' : habit.emoji}
                                                            {hasMultipleSteps && !isCompleted && (
                                                                <div className="absolute -bottom-1 -right-1 bg-white text-gray-800 text-xs font-bold px-1.5 py-0.5 rounded-full shadow">
                                                                    +1
                                                                </div>
                                                            )}
                                                        </button>
                                                        
                                                        <div className="flex-1 min-w-0" onClick={() => setShowHabitDetail(habit)}>
                                                            <p className={`font-semibold text-gray-800 dark:text-white ${isCompleted ? 'line-through opacity-50' : ''}`}>
                                                                {habit.name}
                                                            </p>
                                                            
                                                            {/* Progress indicator for multi-step habits */}
                                                            {hasMultipleSteps && (
                                                                <div className="mt-2">
                                                                    <div className="flex items-center justify-between text-xs mb-1">
                                                                        <span className={`font-bold ${isCompleted ? 'text-green-600' : 'text-gray-600 dark:text-gray-400'}`}>
                                                                            {todayProgress} / {goal} {habit.unit}
                                                                        </span>
                                                                        <span className={`font-semibold ${isCompleted ? 'text-green-600' : 'text-purple-600'}`}>
                                                                            {Math.round(progressPercent)}%
                                                                        </span>
                                                                    </div>
                                                                    <div className="h-2 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden">
                                                                        <div 
                                                                            className={`h-full transition-all duration-500 rounded-full ${isCompleted ? 'bg-gradient-to-r from-green-400 to-emerald-500' : `bg-gradient-to-r ${habit.color}`}`}
                                                                            style={{ width: `${progressPercent}%` }}
                                                                        />
                                                                    </div>
                                                                </div>
                                                            )}
                                                            
                                                            {!hasMultipleSteps && habit.identity && (
                                                                <p className="text-xs text-purple-600 dark:text-purple-400 mt-0.5">
                                                                    ‚Üí Becoming a {habit.identity}
                                                                </p>
                                                            )}
                                                            
                                                            <div className="flex items-center gap-3 mt-1">
                                                                <span className={`streak-badge text-white text-xs font-bold px-2 py-0.5 rounded-full flex items-center gap-1 ${habit.streak > 0 ? 'animate-streak-fire' : ''}`}>
                                                                    üî• {habit.streak}
                                                                </span>
                                                                <span className="text-xs text-gray-400">{habit.category}</span>
                                                            </div>
                                                        </div>
                                                        
                                                        {!isCompleted && (
                                                            <div className="flex flex-col gap-1">
                                                                {hasMultipleSteps ? (
                                                                    <>
                                                                        <button
                                                                            onClick={() => incrementHabit(habit.id, 1)}
                                                                            className={`px-3 py-2 rounded-xl text-sm font-bold text-white bg-gradient-to-r ${habit.color} shadow-md hover:shadow-lg transition-all active:scale-95 btn-premium`}
                                                                        >
                                                                            +1
                                                                        </button>
                                                                        {goal > 5 && (
                                                                            <button
                                                                                onClick={() => incrementHabit(habit.id, Math.ceil(goal / 4))}
                                                                                className="px-3 py-1 rounded-lg text-xs font-semibold text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-all"
                                                                            >
                                                                                +{Math.ceil(goal / 4)}
                                                                            </button>
                                                                        )}
                                                                    </>
                                                                ) : (
                                                                    <button
                                                                        onClick={() => completeHabit(habit.id)}
                                                                        className={`px-4 py-2 rounded-xl text-sm font-bold text-white bg-gradient-to-r ${habit.color} shadow-md hover:shadow-lg transition-all active:scale-95 btn-premium`}
                                                                    >
                                                                        Done
                                                                    </button>
                                                                )}
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>

                                {/* Add Habit Buttons */}
                                <div className="flex gap-3">
                                    <button
                                        onClick={() => setShowTemplates(true)}
                                        className="flex-1 premium-card rounded-2xl p-4 flex items-center justify-center gap-2 text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/20 transition-colors"
                                    >
                                        <span className="text-2xl">üìã</span>
                                        <span className="font-semibold">Templates</span>
                                    </button>
                                    <button
                                        onClick={() => setShowAddHabit(true)}
                                        className="flex-1 premium-card rounded-2xl p-4 flex items-center justify-center gap-2 text-gray-400 hover:text-purple-600 transition-colors border-2 border-dashed border-gray-200 dark:border-gray-700"
                                    >
                                        <span className="text-2xl">+</span>
                                        <span className="font-semibold">Custom</span>
                                    </button>
                                </div>
                            </div>
                        )}

                        {activeTab === 'analytics' && (
                            <div className="px-5 py-6 space-y-6 animate-slide-down">
                                <div className="premium-card rounded-3xl p-6">
                                    <h2 className="font-bold text-gray-800 dark:text-white mb-4">30-Day Overview</h2>
                                    <div className="flex items-end justify-between h-32 gap-1">
                                        {analyticsData.last30Days.map((day, i) => (
                                            <div
                                                key={day.date}
                                                className="flex-1 bg-gradient-to-t from-violet-500 to-purple-400 rounded-t-sm chart-bar"
                                                style={{ height: `${Math.max(4, day.rate)}%` }}
                                                title={`${day.date}: ${day.rate}%`}
                                            />
                                        ))}
                                    </div>
                                    <div className="flex justify-between text-xs text-gray-400 mt-2">
                                        <span>30 days ago</span>
                                        <span>Today</span>
                                    </div>
                                </div>

                                {/* Stats Grid */}
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="premium-card rounded-2xl p-5 text-center">
                                        <p className="text-3xl font-black text-gray-800 dark:text-white animate-number-pop">{Math.round(analyticsData.avgRate)}%</p>
                                        <p className="text-sm text-gray-500">Avg. Completion</p>
                                    </div>
                                    <div className="premium-card rounded-2xl p-5 text-center">
                                        <p className="text-3xl font-black text-gray-800 dark:text-white">{user.totalCompletions}</p>
                                        <p className="text-sm text-gray-500">Total Completions</p>
                                    </div>
                                    <div className="premium-card rounded-2xl p-5 text-center">
                                        <p className="text-3xl font-black text-gray-800 dark:text-white">{user.longestStreak}</p>
                                        <p className="text-sm text-gray-500">Best Streak</p>
                                    </div>
                                    <div className="premium-card rounded-2xl p-5 text-center">
                                        <p className="text-3xl font-black text-gray-800 dark:text-white">{user.perfectDays}</p>
                                        <p className="text-sm text-gray-500">Perfect Days</p>
                                    </div>
                                </div>

                                {/* Insights */}
                                <div className="space-y-3">
                                    <h3 className="font-bold text-white">Smart Insights</h3>
                                    
                                    <div className="insight-card rounded-2xl p-4">
                                        <div className="flex items-center gap-3">
                                            <span className="text-2xl">{analyticsData.trend >= 0 ? 'üìà' : 'üìâ'}</span>
                                            <div>
                                                <p className="font-semibold text-white">Weekly Trend</p>
                                                <p className="text-sm text-white/70">
                                                    {analyticsData.trend >= 0 
                                                        ? `Up ${Math.round(analyticsData.trend)}% from last week!` 
                                                        : `Down ${Math.abs(Math.round(analyticsData.trend))}% - time to refocus`}
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="insight-card rounded-2xl p-4">
                                        <div className="flex items-center gap-3">
                                            <span className="text-2xl">üèÜ</span>
                                            <div>
                                                <p className="font-semibold text-white">Best Performance</p>
                                                <p className="text-sm text-white/70">
                                                    Your best day was {analyticsData.bestDay.date} at {analyticsData.bestDay.rate}%
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    {habits.length > 0 && (
                                        <div className="insight-card rounded-2xl p-4">
                                            <div className="flex items-center gap-3">
                                                <span className="text-2xl">üî•</span>
                                                <div>
                                                    <p className="font-semibold text-white">Strongest Habit</p>
                                                    <p className="text-sm text-white/70">
                                                        {habits.reduce((best, h) => h.streak > best.streak ? h : best).name} ({habits.reduce((best, h) => h.streak > best.streak ? h : best).streak} day streak)
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}

                        {activeTab === 'achievements' && (
                            <div className="px-5 py-6 space-y-6 animate-slide-down">
                                {/* Achievement Summary */}
                                <div className="premium-card rounded-3xl p-6 text-center">
                                    <div className="text-6xl mb-3">üèÜ</div>
                                    <p className="text-4xl font-black text-gray-800 dark:text-white">{user.achievements?.length || 0}/{allAchievements.length}</p>
                                    <p className="text-gray-500">Achievements Unlocked</p>
                                </div>

                                {/* Level Progress */}
                                <div className="premium-card rounded-3xl p-6">
                                    <div className="flex items-center justify-between mb-4">
                                        <div>
                                            <p className="text-sm text-gray-500">Current Level</p>
                                            <p className="text-3xl font-black text-gradient">Level {user.level}</p>
                                        </div>
                                        <div className="text-right">
                                            <p className="text-sm text-gray-500">Next Level</p>
                                            <p className="text-lg font-bold text-gray-800 dark:text-white">{user.level * 100 - user.xp} XP needed</p>
                                        </div>
                                    </div>
                                    <div className="h-4 bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden">
                                        <div 
                                            className="h-full bg-gradient-to-r from-violet-500 via-purple-500 to-fuchsia-500 transition-all duration-500"
                                            style={{ width: `${(user.xp / (user.level * 100)) * 100}%` }}
                                        />
                                    </div>
                                </div>

                                {/* XP Earning Guide */}
                                <div className="premium-card rounded-2xl p-5">
                                    <h3 className="font-bold text-gray-800 dark:text-white mb-3">Earn XP</h3>
                                    <div className="space-y-2">
                                        <div className="flex justify-between items-center py-2">
                                            <span className="text-gray-600 dark:text-gray-400">‚úÖ Complete a habit</span>
                                            <span className="font-bold text-purple-600">+25 XP</span>
                                        </div>
                                        <div className="flex justify-between items-center py-2">
                                            <span className="text-gray-600 dark:text-gray-400">üíé Perfect day bonus</span>
                                            <span className="font-bold text-purple-600">+50 XP</span>
                                        </div>
                                        <div className="flex justify-between items-center py-2">
                                            <span className="text-gray-600 dark:text-gray-400">üî• 7-day streak</span>
                                            <span className="font-bold text-purple-600">+100 XP</span>
                                        </div>
                                    </div>
                                </div>

                                {/* All Achievements */}
                                <h3 className="font-bold text-white">All Achievements</h3>
                                <div className="grid grid-cols-2 gap-3">
                                    {allAchievements.map(achievement => {
                                        const unlocked = user.achievements?.includes(achievement.id);
                                        return (
                                            <div 
                                                key={achievement.id}
                                                className={`premium-card rounded-2xl p-4 transition-all ${unlocked ? 'ring-2 ring-yellow-400' : 'opacity-60'}`}
                                            >
                                                <div className={`text-4xl mb-2 ${unlocked ? '' : 'grayscale'}`}>{achievement.emoji}</div>
                                                <p className="font-bold text-sm text-gray-800 dark:text-white">{achievement.name}</p>
                                                <p className="text-xs text-gray-500 mt-1">{achievement.desc}</p>
                                                {unlocked && (
                                                    <div className="mt-2 text-xs font-bold text-green-500">‚úì Unlocked</div>
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        )}

                        {activeTab === 'settings' && (
                            <div className="px-5 py-6 space-y-6 animate-slide-down">
                                {/* Profile Card */}
                                <div className="premium-card rounded-3xl p-6">
                                    <div className="flex items-center gap-4 mb-6">
                                        <div className="w-20 h-20 rounded-3xl bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center text-4xl shadow-lg">
                                            {user.avatar}
                                        </div>
                                        <div>
                                            <input
                                                type="text"
                                                value={user.name}
                                                onChange={(e) => setUser(u => ({ ...u, name: e.target.value }))}
                                                className="text-xl font-bold text-gray-800 dark:text-white bg-transparent border-none outline-none"
                                            />
                                            <p className="text-sm text-gray-500">Level {user.level} ‚Ä¢ {user.totalCompletions} completions</p>
                                        </div>
                                    </div>

                                    <div className="space-y-4">
                                        <div>
                                            <label className="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block">Avatar</label>
                                            <div className="flex flex-wrap gap-2">
                                                {['ü¶∏', 'üßô', 'ü•∑', 'ü¶π', 'üëë', 'üéØ', 'üöÄ', '‚ö°', 'üî•', 'üíé', 'üåü', 'ü¶Ñ'].map(avatar => (
                                                    <button
                                                        key={avatar}
                                                        onClick={() => setUser(u => ({ ...u, avatar }))}
                                                        className={`w-12 h-12 rounded-xl text-2xl transition-all ${user.avatar === avatar ? 'bg-purple-100 dark:bg-purple-900 ring-2 ring-purple-500' : 'bg-gray-100 dark:bg-gray-800'}`}
                                                    >
                                                        {avatar}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Theme Selection */}
                                <div className="premium-card rounded-3xl p-6">
                                    <h3 className="font-bold text-gray-800 dark:text-white mb-4">Theme</h3>
                                    <div className="grid grid-cols-2 gap-3">
                                        {Object.entries(themes).map(([name, gradient]) => (
                                            <button
                                                key={name}
                                                onClick={() => setUser(u => ({ ...u, theme: name }))}
                                                className={`h-16 rounded-2xl bg-gradient-to-r ${gradient} transition-all ${user.theme === name ? 'ring-4 ring-white ring-offset-2 ring-offset-gray-800 shadow-lg' : ''}`}
                                            >
                                                <span className="text-white font-semibold capitalize">{name}</span>
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {/* App Info */}
                                <div className="premium-card rounded-3xl p-6 text-center">
                                    <div className="text-4xl mb-3">‚ú®</div>
                                    <h3 className="font-bold text-gray-800 dark:text-white text-lg">Momentum</h3>
                                    <p className="text-sm text-gray-500">Premium Habit System v2.0</p>
                                    <p className="text-xs text-gray-400 mt-2">Your data is saved locally</p>
                                </div>

                                {/* Reset Button */}
                                <button
                                    onClick={() => {
                                        if (confirm('Reset all data? This cannot be undone.')) {
                                            localStorage.clear();
                                            window.location.reload();
                                        }
                                    }}
                                    className="w-full py-4 bg-red-50 dark:bg-red-900/20 text-red-600 rounded-2xl font-semibold"
                                >
                                    Reset All Data
                                </button>
                            </div>
                        )}
                    </main>

                    {/* Tab Bar */}
                    <nav className="tab-bar fixed bottom-0 left-0 right-0 border-t border-gray-100 dark:border-gray-800 px-2 py-2 safe-area-inset-bottom">
                        <div className="flex justify-around">
                            {[
                                { id: 'habits', icon: 'üéØ', label: 'Habits' },
                                { id: 'analytics', icon: 'üìä', label: 'Analytics' },
                                { id: 'achievements', icon: 'üèÜ', label: 'Rewards' },
                                { id: 'settings', icon: '‚öôÔ∏è', label: 'Settings' },
                            ].map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`flex flex-col items-center py-2 px-4 rounded-2xl transition-all ${
                                        activeTab === tab.id 
                                            ? 'bg-gradient-to-r from-violet-500 to-purple-600 text-white shadow-lg' 
                                            : 'text-gray-400'
                                    }`}
                                >
                                    <span className="text-xl mb-0.5">{tab.icon}</span>
                                    <span className="text-xs font-semibold">{tab.label}</span>
                                </button>
                            ))}
                        </div>
                    </nav>

                    {/* Templates Modal */}
                    {showTemplates && (
                        <div className="fixed inset-0 bg-black/60 backdrop-blur-sm z-40 flex items-end justify-center" onClick={() => setShowTemplates(false)}>
                            <div className="bg-white dark:bg-gray-900 rounded-t-3xl w-full max-w-lg p-6 animate-slide-up max-h-[85vh] overflow-y-auto" onClick={e => e.stopPropagation()}>
                                <div className="flex items-center justify-between mb-4">
                                    <div>
                                        <h2 className="text-2xl font-black text-gray-800 dark:text-white">Habit Templates</h2>
                                        <p className="text-sm text-gray-500">Choose from {habitTemplates.length} proven habits</p>
                                    </div>
                                    <button onClick={() => setShowTemplates(false)} className="text-gray-400 text-2xl">√ó</button>
                                </div>

                                {/* Template categories */}
                                {['Health', 'Fitness', 'Wellness', 'Learning', 'Productivity', 'Social', 'Creative'].map(category => {
                                    const categoryTemplates = habitTemplates.filter(t => t.category === category);
                                    return (
                                        <div key={category} className="mb-6">
                                            <h3 className="text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">{category}</h3>
                                            <div className="space-y-2">
                                                {categoryTemplates.map((template, idx) => (
                                                    <button
                                                        key={idx}
                                                        onClick={() => addFromTemplate(template)}
                                                        className="w-full flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-2xl transition-all text-left group"
                                                    >
                                                        <div className={`w-12 h-12 rounded-xl bg-gradient-to-br ${template.color} flex items-center justify-center text-xl shadow-md group-hover:shadow-lg transition-shadow`}>
                                                            {template.emoji}
                                                        </div>
                                                        <div className="flex-1 min-w-0">
                                                            <p className="font-semibold text-gray-800 dark:text-white">{template.name}</p>
                                                            <div className="flex items-center gap-2 mt-0.5">
                                                                {template.goal > 1 && (
                                                                    <span className="text-xs bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 px-2 py-0.5 rounded-full font-medium">
                                                                        Goal: {template.goal} {template.unit}
                                                                    </span>
                                                                )}
                                                                <span className="text-xs text-gray-400">‚Üí {template.identity}</span>
                                                            </div>
                                                        </div>
                                                        <div className="text-gray-300 dark:text-gray-600 group-hover:text-purple-500 transition-colors">
                                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                                                <path d="M12 5v14M5 12h14"/>
                                                            </svg>
                                                        </div>
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    );
                                })}
                                
                                <div className="sticky bottom-0 pt-4 bg-white dark:bg-gray-900">
                                    <button
                                        onClick={() => { setShowTemplates(false); setShowAddHabit(true); }}
                                        className="w-full py-4 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-2xl font-semibold hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"
                                    >
                                        Create Custom Habit Instead
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Add Habit Modal */}
                    {showAddHabit && (
                        <div className="fixed inset-0 bg-black/60 backdrop-blur-sm z-40 flex items-end justify-center" onClick={() => setShowAddHabit(false)}>
                            <div className="bg-white dark:bg-gray-900 rounded-t-3xl w-full max-w-lg p-6 animate-slide-up max-h-[85vh] overflow-y-auto" onClick={e => e.stopPropagation()}>
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-2xl font-black text-gray-800 dark:text-white">New Habit</h2>
                                    <button onClick={() => setShowAddHabit(false)} className="text-gray-400 text-2xl">√ó</button>
                                </div>

                                <div className="space-y-5">
                                    <div>
                                        <label className="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block">Habit Name</label>
                                        <input
                                            type="text"
                                            id="habitName"
                                            placeholder="e.g., Meditate for 10 minutes"
                                            className="w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border-2 border-transparent focus:border-purple-500 rounded-2xl outline-none transition-colors text-gray-800 dark:text-white"
                                        />
                                    </div>

                                    <div className="grid grid-cols-2 gap-3">
                                        <div>
                                            <label className="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block">Daily Goal</label>
                                            <input
                                                type="number"
                                                id="habitGoal"
                                                placeholder="1"
                                                defaultValue="1"
                                                min="1"
                                                className="w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border-2 border-transparent focus:border-purple-500 rounded-2xl outline-none transition-colors text-gray-800 dark:text-white"
                                            />
                                        </div>
                                        <div>
                                            <label className="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block">Unit (optional)</label>
                                            <input
                                                type="text"
                                                id="habitUnit"
                                                placeholder="e.g., min, pages, glasses"
                                                className="w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border-2 border-transparent focus:border-purple-500 rounded-2xl outline-none transition-colors text-gray-800 dark:text-white"
                                            />
                                        </div>
                                    </div>

                                    <div>
                                        <label className="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block">Identity (Who are you becoming?)</label>
                                        <input
                                            type="text"
                                            id="habitIdentity"
                                            placeholder="e.g., mindful person"
                                            className="w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border-2 border-transparent focus:border-purple-500 rounded-2xl outline-none transition-colors text-gray-800 dark:text-white"
                                        />
                                    </div>

                                    <div>
                                        <label className="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block">Emoji</label>
                                        <div className="flex flex-wrap gap-2">
                                            {['üßò', 'üìö', 'üí™', 'üíß', 'üèÉ', '‚úçÔ∏è', 'üé∏', 'ü•ó', 'üò¥', 'üìµ', 'üß†', 'üíä'].map(emoji => (
                                                <button
                                                    key={emoji}
                                                    type="button"
                                                    onClick={(e) => {
                                                        document.querySelectorAll('.emoji-btn').forEach(b => b.classList.remove('ring-2', 'ring-purple-500'));
                                                        e.target.classList.add('ring-2', 'ring-purple-500');
                                                        e.target.dataset.selected = 'true';
                                                    }}
                                                    className="emoji-btn w-12 h-12 bg-gray-50 dark:bg-gray-800 rounded-xl text-2xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                                                    data-emoji={emoji}
                                                >
                                                    {emoji}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    <div>
                                        <label className="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block">Color</label>
                                        <div className="grid grid-cols-4 gap-2">
                                            {[
                                                'from-violet-500 to-purple-600',
                                                'from-blue-500 to-cyan-500',
                                                'from-green-500 to-emerald-500',
                                                'from-orange-500 to-rose-500',
                                                'from-pink-500 to-rose-500',
                                                'from-cyan-400 to-blue-500',
                                                'from-amber-400 to-orange-500',
                                                'from-emerald-400 to-teal-500',
                                            ].map(color => (
                                                <button
                                                    key={color}
                                                    type="button"
                                                    onClick={(e) => {
                                                        document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('ring-4', 'ring-gray-800'));
                                                        e.target.classList.add('ring-4', 'ring-gray-800');
                                                        e.target.dataset.selected = 'true';
                                                    }}
                                                    className={`color-btn h-12 rounded-xl bg-gradient-to-r ${color}`}
                                                    data-color={color}
                                                />
                                            ))}
                                        </div>
                                    </div>

                                    <div>
                                        <label className="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block">Category</label>
                                        <select
                                            id="habitCategory"
                                            className="w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 rounded-2xl outline-none text-gray-800 dark:text-white"
                                        >
                                            {categories.filter(c => c !== 'All').map(cat => (
                                                <option key={cat} value={cat}>{cat}</option>
                                            ))}
                                        </select>
                                    </div>

                                    <button
                                        onClick={() => {
                                            const name = document.getElementById('habitName').value;
                                            const identity = document.getElementById('habitIdentity').value;
                                            const category = document.getElementById('habitCategory').value;
                                            const goal = parseInt(document.getElementById('habitGoal').value) || 1;
                                            const unit = document.getElementById('habitUnit').value;
                                            const selectedEmoji = document.querySelector('.emoji-btn[data-selected="true"]');
                                            const selectedColor = document.querySelector('.color-btn[data-selected="true"]');
                                            
                                            if (name) {
                                                addHabit({
                                                    name,
                                                    identity,
                                                    category,
                                                    goal,
                                                    unit,
                                                    emoji: selectedEmoji?.dataset.emoji || '‚≠ê',
                                                    color: selectedColor?.dataset.color || 'from-violet-500 to-purple-600'
                                                });
                                            }
                                        }}
                                        className="w-full py-4 bg-gradient-to-r from-violet-500 to-purple-600 text-white rounded-2xl font-bold text-lg shadow-lg hover:shadow-xl transition-all active:scale-95"
                                    >
                                        Create Habit
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Habit Detail Modal */}
                    {showHabitDetail && (
                        <div className="fixed inset-0 bg-black/60 backdrop-blur-sm z-40 flex items-end justify-center" onClick={() => setShowHabitDetail(null)}>
                            <div className="bg-white dark:bg-gray-900 rounded-t-3xl w-full max-w-lg p-6 animate-slide-up" onClick={e => e.stopPropagation()}>
                                <div className="flex items-center gap-4 mb-6">
                                    <div className={`w-16 h-16 rounded-2xl bg-gradient-to-br ${showHabitDetail.color} flex items-center justify-center text-3xl shadow-lg`}>
                                        {showHabitDetail.emoji}
                                    </div>
                                    <div>
                                        <h2 className="text-xl font-bold text-gray-800 dark:text-white">{showHabitDetail.name}</h2>
                                        <p className="text-sm text-gray-500">{showHabitDetail.category}</p>
                                    </div>
                                </div>

                                {/* Today's Progress for multi-step habits */}
                                {(showHabitDetail.goal || 1) > 1 && (
                                    <div className="bg-gradient-to-r from-violet-50 to-purple-50 dark:from-violet-900/20 dark:to-purple-900/20 rounded-2xl p-4 mb-4">
                                        <div className="flex items-center justify-between mb-2">
                                            <p className="text-sm font-semibold text-gray-700 dark:text-gray-300">Today's Progress</p>
                                            <p className="text-sm font-bold text-purple-600">
                                                {showHabitDetail.progress?.[today] || 0} / {showHabitDetail.goal} {showHabitDetail.unit}
                                            </p>
                                        </div>
                                        <div className="h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                                            <div 
                                                className={`h-full transition-all duration-500 rounded-full bg-gradient-to-r ${showHabitDetail.color}`}
                                                style={{ width: `${Math.min(((showHabitDetail.progress?.[today] || 0) / showHabitDetail.goal) * 100, 100)}%` }}
                                            />
                                        </div>
                                        
                                        {/* Quick add buttons */}
                                        <div className="flex gap-2 mt-3">
                                            {[1, Math.ceil(showHabitDetail.goal / 4), Math.ceil(showHabitDetail.goal / 2)].filter((v, i, a) => a.indexOf(v) === i && v <= showHabitDetail.goal).map(amount => (
                                                <button
                                                    key={amount}
                                                    onClick={() => {
                                                        incrementHabit(showHabitDetail.id, amount);
                                                        // Update the detail view
                                                        const updated = habits.find(h => h.id === showHabitDetail.id);
                                                        if (updated) setShowHabitDetail({...updated, progress: {...updated.progress, [today]: (updated.progress?.[today] || 0) + amount}});
                                                    }}
                                                    disabled={(showHabitDetail.progress?.[today] || 0) >= showHabitDetail.goal}
                                                    className={`flex-1 py-2 rounded-xl text-sm font-bold transition-all ${
                                                        (showHabitDetail.progress?.[today] || 0) >= showHabitDetail.goal
                                                            ? 'bg-gray-200 text-gray-400 cursor-not-allowed'
                                                            : `bg-gradient-to-r ${showHabitDetail.color} text-white shadow-md hover:shadow-lg active:scale-95`
                                                    }`}
                                                >
                                                    +{amount} {showHabitDetail.unit}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                <div className="grid grid-cols-2 gap-4 mb-6">
                                    <div className="bg-gradient-to-br from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 rounded-2xl p-4 text-center">
                                        <p className="text-3xl font-black text-orange-600">üî• {showHabitDetail.streak}</p>
                                        <p className="text-sm text-gray-600 dark:text-gray-400">Current Streak</p>
                                    </div>
                                    <div className="bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-2xl p-4 text-center">
                                        <p className="text-3xl font-black text-purple-600">{showHabitDetail.completedDates?.length || 0}</p>
                                        <p className="text-sm text-gray-600 dark:text-gray-400">Days Completed</p>
                                    </div>
                                </div>

                                {showHabitDetail.identity && (
                                    <div className="bg-gradient-to-r from-violet-50 to-purple-50 dark:from-violet-900/20 dark:to-purple-900/20 rounded-2xl p-4 mb-4">
                                        <p className="text-sm text-gray-500 dark:text-gray-400">Identity</p>
                                        <p className="font-semibold text-purple-700 dark:text-purple-300">Becoming a {showHabitDetail.identity}</p>
                                    </div>
                                )}
                                
                                {(showHabitDetail.goal || 1) > 1 && (
                                    <div className="bg-gray-50 dark:bg-gray-800 rounded-2xl p-4 mb-4">
                                        <p className="text-sm text-gray-500 dark:text-gray-400">Daily Goal</p>
                                        <p className="font-semibold text-gray-800 dark:text-white">{showHabitDetail.goal} {showHabitDetail.unit} per day</p>
                                    </div>
                                )}

                                <button
                                    onClick={() => deleteHabit(showHabitDetail.id)}
                                    className="w-full py-3 bg-red-50 dark:bg-red-900/20 text-red-600 rounded-2xl font-semibold"
                                >
                                    Delete Habit
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<MomentumApp />, document.getElementById('root'));
    </script>
</body>
</html>
